# **《武松：血溅鸳鸯楼》游戏设计文档 (v1.0)**

## **一、 项目愿景与核心目标**

- **项目名称:** 武松：血溅鸳鸯楼 (暂定)
- **游戏类型:** 2D横版、叙事驱动、潜行解谜
- **核心体验:** 让玩家**亲身扮演**水浒传中的武松，以**极度忠于原著**的方式，经历从潜入张都监府到复仇成功的整个夜晚。体验其隐忍、果决、狠辣的行事风格。
- **艺术风格:** 手绘半写实风格，利用Unity URP 2D光照系统营造阴暗、压抑、最终爆发的夜晚复仇氛围。
- **目标平台:** PC (后续可考虑移植)
- **开发周期:** 2个月 (1个月Alpha， 2个月Beta测试版)
- **核心原则:** 玩法服务于叙事，机制还原原著。**不做复杂系统，只做必要交互。**

---

## **二、 核心玩法机制**

游戏围绕三大核心互动机制展开：

1. **光影隐匿系统:**
    - **描述:** 武松需隐藏在阴影中规避守卫视野。URP 2D灯光定义"光亮"区域，未被照到即为"阴影"。
    - **玩家反馈:** 武松Sprite在阴影中颜色变深，屏幕边缘出现隐匿UI提示。
    - **AI关联:** 守卫视野与其携带的光源（灯笼、火把）绑定。
2. **观察与聆听系统:**
    - **描述:** 在特定区域（Trigger），武松静止不动可偷听NPC对话，获取关键情报（如目标位置、敌人状态）。
    - **UI表现:** 台词以字幕形式显示于屏幕下方，并自动记录于"情报日志"。
    - **高级应用:** 在鸳鸯楼胡梯口，聆听是解锁后续剧情的关键谜题。
3. **环境互动系统:**
    - **描述:** 与场景中的关键物品进行上下文交互，推动剧情发展。所有交互简单直接（靠近按空格）。
    - **关键交互:**
        - **推门:** 制造声响，吸引门内NPC。
        - **拖拽尸体:** 隐藏痕迹，避免被发现。
        - **更换衣物:** 获取伪装，改变NPC对玩家的反应。
        - **熄灭灯火:** 制造黑暗区域，便于潜行。
        - **题字:** 游戏终局的仪式性交互。

---

## **三、 关卡流程设计 (极度还原原著)**

### **关卡一: 夜潜张府 (马院)**

- **目标:** 潜入后槽房间，换装并获取情报。
- **流程:**
    1. **观察:** 潜伏于马院阴影，观察后槽例行公事（喂马、挂灯、睡觉）。
    2. **互动-惊敌:** 后槽睡下后，前往其屋门进行两次"推门"交互，激怒他出门查看。
    3. **QTE处决:** 门开瞬间，完成简单QTE，制服后槽。
    4. **逼问:** 通过对话树选择问话，获取"目标在鸳鸯楼"的情报。
    5. **清扫:** 执行"吹灯"、"换装"、"藏尸"一系列操作后，方可离开。

### **关卡二: 厨房杀诫**

- **目标:** 听清情报后，迅速无声地解决两个丫鬟。
- **流程:**
    1. **聆听:** 于窗外阴影处静止，完整听完丫鬟对话，获知"楼上人已醉"的关键信息。
    2. **决断:** 推门而入，游戏进入慢动作。
    3. **快速处决:** 在限定时间内，用鼠标快速点击两个目标，完成双杀。超时或失败将引发额外混乱。
    4. **清扫:** "拖尸"、"灭灶火"后离开。

### **关卡三: 鸳鸯楼听密**

- **目标:** 摸上楼，听清所有对话，点燃怒火。
- **流程:**
    1. **潜行:** 利用光影，按节奏走上楼梯，避开月光。
    2. **听力解谜:** 在胡梯口，通过微调位置（左右移动）使楼上对话逐渐清晰。收集全部5条关键罪证。
    3. **怒火爆发:** 情报集齐瞬间，屏幕特效与音效达到顶峰，按下【复仇！！！】键，剧情推向高潮。

### **终局: 血溅鸳鸯楼**

- **目标:** 手刃仇人，留名离去。
- **流程:**
    1. **风暴开场:** 冲入房间，对第一目标蒋门神执行**剧情QTE处决**。
    2. **顺序抉择:** 玩家自主选择下一个目标。
        - **正确顺序 (张都监 -> 张团练):** 触发流畅处决动画。
        - **错误顺序:** 与张都监进入短暂搏斗，增加难度作为惩罚。
    3. **仪式收尾:** 走到墙边，通过"题字"小游戏写下"杀人者打虎武松也"。
    4. **离去:** 从窗台跳下，融入月色，游戏结束。

---

## **四、 技术实现方案 (极简主义)**

1. **光影检测:** 使用`Light2D.GetIntensityAt()`方法检测武松位置光照强度，低于阈值即判定为隐匿。 (简单高效)
2. **NPC AI:** 采用**有限状态机(FSM)** 而非复杂行为树。状态包括：巡逻(Patrol)、调查(Investigate)、追击(Chase)、死亡(Dead)。
3. **脚本化序列:** 对于后槽等有固定流程的NPC，使用**协程(Coroutine)** 控制其移动和行为，按时间线触发事件。
4. **QTE系统:** 在需要时激活UI提示按键。结果仅为**播放不同动画**（成功处决动画/失败搏斗动画）。
5. **音频管理:** 为不同区域设置`Audio Trigger`，玩家进入时播放对应环境音或对话。

---

## **五、 开发里程碑与时间表**

| **时间** | **阶段** | **目标** |
| --- | --- | --- |
| **第1-2周** | **核心原型** | 完成玩家移动、基础光影检测、后槽脚本化序列、基础交互（推门）。 |
| **第3-4周** | **Alpha版本** | **完成"马院"关卡全部内容**。集成最终手绘美术、音效。实现从潜入到换装离开的完整闭环。可玩、无致命BUG。 |
| **第5-6周** | **系统扩展** | 搭建厨房、鸳鸯楼场景白盒。实现聆听系统、处决QTE、怒火积累UI。 |
| **第7-8周** | **Beta版本** | **集成所有最终美术和音效**。连接所有关卡，实现题字功能。进行封闭测试，收集反馈，进行最终打磨。 |

---

## **六、 风险与应对策略**

- **风险:** 过度追求还原度导致开发复杂度飙升。
- **策略:** **严格遵循"极简实现"方案**。用脚本动画、UI提示和玩家的想象力来"暗示"复杂逻辑，而非真正实现它。
- **风险:** 玩家卡关，不理解谜题逻辑。
- **策略:** 加入适当的**环境提示**（如后槽的灯笼光照范围可视化）和**武松的内心独白文字**进行引导。

---

## **七、 核心玩法重塑：基于原著的"观察-等待-互动"链条**

我们将用一套更复杂、更还原的"**环境互动与时机把握**"玩法取代"投石引敌"。核心循环是：**观察环境 -> 理解NPC行为模式 -> 在正确的时间点进行交互**。

### **关卡1：马院杀后槽 - 详细玩法分解**

**场景构成：**

- **横版视角：** 左侧是马院入口（角门），中间是马厩和草料堆，右侧是后槽的小屋。小屋有门和一扇小窗。
- **光源：** 后槽手提的灯笼（移动光源）、小屋内桌上的油灯（固定光源）、微弱的月光（环境光）。
- **关键物品：** 草料、灯笼（可交互）、屋门（可交互）、油灯（可交互）、后槽的衣裳和床（触发器）。
- **NPC：** 后槽。他有严格的行为树（Scripted Routine），完全模仿原文。

**玩家目标：** 潜入小屋，杀掉后槽，换装并获取情报。

**分步玩法设计：**

1. **初始潜伏 (观察阶段)**
    - 游戏开始，武松伏在马院墙边的**阴影**中。
    - **呀地一声**，角门打开，后槽提**灯笼**出场。玩家必须立刻操作武松移动到最近的阴影（如草料堆后），**灯笼的光照范围会清晰可见**，一旦照到武松即失败。
    - 后槽开始执行固定 routine：**上草料 -> 挂起灯笼 -> 铺床 -> 脱衣 -> 上床睡觉**。
    - **玩法：** 玩家在此期间只能观察，不能行动。这是一个强制性的观察阶段，让玩家**学习并记住后槽的完整行为模式**。当他吹灭灯笼上床后，主要光源消失，场景变暗，仅剩月光和小屋窗户透出的微弱灯光。
2. **惊敌出门 (互动阶段)**
    - 后槽睡下后，玩家可以自由移动。走到**小屋门**边，会出现交互提示"推门"。
    - **第一次推门：** 武松轻轻推门，门发出响声。屋内后槽会发出抱怨（"老爷方才睡，你要偷我衣裳也早些哩！"）。**这是一个信号：他现在醒了，且有警惕性，但还未起身。**
    - **等待：** 玩家需要等待几秒，让后槽的警惕值下降（可以设计一个细微的音效提示他重新睡熟）。
    - **第二次推门：** 再次交互，武松更用力地推门（"呀呀地推门"）。这次交互成功后，会触发剧情：后槽被彻底激怒，**从床上跳下，拿起搅草棍，前来开门**。
3. **狭路对决 (QTE处决)**
    - 门打开的一瞬间，游戏进入一个**短暂的慢动作特写镜头**。
    - 后槽赤条条地出现，举着棍子。玩家面前出现一个**简单的QTE按键提示**（如猛按【F】键象征武松"就势推开去，抢入来"的力量）。
    - QTE成功，镜头切回，武松已将其制服，刀架在脖子上。QTE失败，则会进入混乱的搏斗，虽然最终能赢但会发出较大声响，为后续关卡增加难度（如守卫警觉性提升）。
4. **逼问与处决 (叙事交互)**
    - 进入一段强制对话树。玩家通过点击选项来逼问：
        - `你认得我么？`（ intimidation）
        - `张都监如今在那里？`（ key information）
        - `这话是实么？`（ confirm）
    - 后槽的回答会直接显示在画面中，并自动记录到"情报日志"："目标在鸳鸯楼饮酒"。
    - 对话结束，最后一个选项永远是：`"恁地却饶你不得！"`。玩家点击后，播放武松手起一刀的处决动画。
5. **换装与清扫 (环境互动)**
    - 处决后，玩家进入"自由操作"阶段，目标是在离开前清理现场。
    - 玩家需要手动操作武松：
        - 走到灯边，按【空格】"吹灭灯火"。
        - 走到床边，按【空格】"解下绵衣"，自动换装。
        - 走到尸体旁，按【空格】"拖放尸首"（将其藏到床下）。
        - （可选）按【空格】"拾取散碎银两"。
    - **设计意义：** 这一连串**模拟真实操作**的交互，极大地增强了"扮演武松"的代入感，远比一个简单的"击杀后获得道具"动画要深刻得多。
6. **最终撤离**
    - 所有操作完成后，玩家才能从屋门离开，进入下一个场景（花园）。

---

*Last Updated: 2025 | Next Review: After Alpha Release*